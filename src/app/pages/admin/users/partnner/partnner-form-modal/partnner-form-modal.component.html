<ng-container *ngIf="loading;">
    <mat-progress-bar [mode]="'indeterminate'" class="mb-5"></mat-progress-bar>
</ng-container>
<div mat-dialog-content>
    <fuse-card class="flex-col w-full max-w-300 p-6 sm:py-12 sm:px-10 filter-pricing border-2 border-gray-100">
        <ng-container *ngIf="!userEdit; else editMode">
            <div class="text-3xl font-bold tracking-tight leading-tight">Novo Usuário</div>
            <div class="mt-2 text-md font-medium tracking-tight text-secondary">Vocês está cadastrando um novo parceiro
                da Plataforma
            </div>
        </ng-container>
        <ng-template #editMode>
            <div class="text-3xl font-bold tracking-tight leading-tight">Editar Usuário</div>
            <div class="mt-2 text-md font-medium tracking-tight text-secondary">Vocês está editando um parceiro da
                Plataforma
            </div>
        </ng-template>
        <!-- Divider -->
        <div class="w-15 h-0.5 mt-3 mb-3 rounded bg-accent"></div>
        <ng-container *ngIf="!loading">

            <div class="flex flex-col mt-2.5">

                <form [formGroup]="accountForm">

                    <!--start: Nome-->
                    <div class="sm:col-span-4">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="name">Nome</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:user'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'name'"
                                id="name"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="accountForm.get('name').hasError('name')">
                            Insira um nome válido
                        </mat-error>
                    </div>
                    <!--end:Nome-->

                    <!--start: Email-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="name">Email</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:mail'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'email'"
                                id="email"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="accountForm.get('email').hasError('email')">
                            Insira um e-mail válido
                        </mat-error>
                    </div>
                    <!--end:Email-->

                    <!--start: cnpj-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="cnpj">CNPJ</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:identification'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'cnpj'"
                                [textMask]="{mask: masks.cnpj.textMask}"
                                cnpj id="cnpj"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="accountForm.get('cnpj').hasError('cnpj')">
                            Insira um cnpj válido
                        </mat-error>
                    </div>
                    <!--end:cnpj-->

                    <!--start:Descrição-->
                    <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                        <mat-label for="description">Descrição</mat-label>
                        <mat-icon
                            [svgIcon]="'heroicons_solid:annotation'"
                            class="icon-size-5 mr-0.5"
                            matPrefix></mat-icon>
                        <input
                            [formControlName]="'description'"
                            id="description"
                            matInput>

                    </mat-form-field>
                    <mat-error *ngIf="accountForm.get('description').hasError('description')">
                        Insira uma descrição válida
                    </mat-error>
                    <!--end:Descrição-->

                    <div class="my-5 border-t"></div>

                </form>
                <form [formGroup]="addressForm">
                    <!--start: CEP-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="cep">CEP</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:hashtag'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                (blur)="getCep($event.target)"
                                [formControlName]="'cep'"
                                [textMask]="{mask: masks.cep.textMask}"
                                cep id="cep"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('cep').hasError('cep')">
                            Insira um cep válido
                        </mat-error>
                    </div>
                    <!--end:CPF-->
                    <!--start: enderecoLogradouro-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="address">Endereço</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:location-marker'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'address'"
                                id="address"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('address').hasError('address')">
                            Insira um endereço válido
                        </mat-error>
                    </div>
                    <!--end:enderecoLogradouro-->
                    <!--start: bairro-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="district">Bairro</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:home'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'district'"
                                id="district"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('district').hasError('district')">
                            Insira um bairro válido
                        </mat-error>
                    </div>
                    <!--end:bairro-->
                    <!--start: estado-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="uf">Estado</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:location-marker'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <mat-select [formControlName]="'uf'">
                                <mat-option *ngFor="let item of states" [value]="item">{{item}}</mat-option>
                            </mat-select>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('uf').hasError('uf')">
                            Insira um cidade válido
                        </mat-error>
                    </div>
                    <!--end:cidade-->
                    <!--start: cidade-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="city">Cidade</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:map'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'city'"
                                id="city"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('city').hasError('city')">
                            Insira um cidade válido
                        </mat-error>
                    </div>
                    <!--end:cidade-->

                    <!--start: numero-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="addressNumber">Número</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:annotation'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'addressNumber'"
                                id="addressNumber"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('addressNumber').hasError('addressNumber')">
                            Insira um numero válido
                        </mat-error>
                    </div>
                    <!--end:numero-->


                    <!--start: complemento-->
                    <div class="sm:col-span-4 mt-2.5">
                        <mat-form-field appearance="legacy" class="fuse-mat-no-subscript w-full">
                            <mat-label for="complement">Complemento</mat-label>
                            <mat-icon
                                [svgIcon]="'heroicons_solid:annotation'"
                                class="icon-size-5 mr-0.5"
                                matPrefix></mat-icon>
                            <input
                                [formControlName]="'complement'"
                                id="complement"
                                matInput>

                        </mat-form-field>
                        <mat-error *ngIf="addressForm.get('complement').hasError('complement')">
                            Insira um numero válido
                        </mat-error>
                    </div>
                    <!--end:numero-->

                </form>
                <form [formGroup]="accountForm">
                    <div class="my-5 border-t"></div>
                    <!--start:telefones-->
                    <div class="sm:col-span-4 mt-2.5">
                        <ng-container
                            *ngFor="let phoneNumber of accountForm.get('phonesNumbers')['controls']; let i = index;"
                            formArrayName="phonesNumbers">
                            <div class="relative flex">
                                <mat-form-field appearance="legacy" class="fuse-mat-no-subscript flex-auto">
                                    <mat-label>Telefone</mat-label>
                                    <input
                                        [formControl]="phoneNumber.get('phoneNumber')"
                                        [placeholder]="'phoneNumber'"
                                        [textMask]="{mask: masks.telefone.textMaskFunction}"
                                        [value]="phoneNumber.value.phoneNumber ?? ''"
                                        matInput
                                        phoneNumber>
                                </mat-form-field>
                                <!-- Remove phone number -->
                                <ng-container>
                                    <div
                                        class="flex items-center w-10 pl-2">
                                        <button
                                            (click)="removePhoneNumber(phoneNumber.value.id ?? 0,i)"
                                            class="w-8 h-8 min-h-8"
                                            mat-icon-button
                                            matTooltip="Remove">
                                            <mat-icon
                                                [svgIcon]="'heroicons_solid:trash'"
                                                class="icon-size-5 text-red-500"></mat-icon>
                                        </button>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                        <!--end:telefones-->
                        <div
                            (click)="addPhoneNumberField()"
                            class="group inline-flex items-center mt-2 -ml-4 py-2 px-4 rounded cursor-pointer">
                            <mat-icon
                                [svgIcon]="'heroicons_solid:plus-circle'"
                                class="icon-size-5"></mat-icon>
                            <span
                                class="ml-2 font-medium text-secondary group-hover:underline">Inserir novo contato</span>
                        </div>
                    </div>
                    <!--end:telefones-->

                </form>
            </div>
            <!-- CTA -->
            <button
                (click)="submit()"
                [color]="'primary'"
                [disabled]="accountForm.invalid || accountForm.disabled"
                class="ml-1 items-center"
                class="fuse-mat-button-large mt-10"
                mat-stroked-button>
                Salvar
            </button>
        </ng-container>
    </fuse-card>

</div>
<div class="mt-5" mat-dialog-actions>
    <button (click)="onNoClick()" mat-button mat-dialog-close>Cancelar</button>
</div>

